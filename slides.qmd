---
title: "Present a great story for data science projects"
subtitle: "This is a Slide Template"
author: "Matt McGehee (Advisor: Dr. Seals)"
date: last-modified
date-format: long
format:
  revealjs
course: Capstone Projects in Data Science
bibliography: references.bib # file contains bibtex for references
#always_allow_html: true # this allows to get PDF with HTML features
self-contained: true
execute: 
  warning: false
  message: false
editor: 
  markdown: 
    wrap: 72
---

## Table 1

```{r}
library(dplyr)
library(Hmisc)
library(table1)

sales_data <- read.csv("data_as_csv.csv")

# Filter out rows where UnitPrice is <= 0
sales_data <- sales_data %>%
  filter(UnitPrice > 0, TotalPrice > 0)

label(sales_data$QuantityFulfilled)   <- "Quantity Fulfilled"
label(sales_data$UnitPrice)           <- "Unit Price"
label(sales_data$TotalPrice)          <- "Total Price"

caption  <- "Basic stats"

group_top_n <- function(column, n = 4) {
  top_n <- names(sort(table(column), decreasing = TRUE))[1:n]
  column <- ifelse(column %in% top_n, column, "Other")
  return(column)
}

sales_data <- sales_data %>%
  mutate(Substrates = group_top_n(Substrate),
         Suppliers = group_top_n(Class))

table1(~ Suppliers + Substrates + QuantityFulfilled + UnitPrice + TotalPrice | SalesOrderStatus,
       data=sales_data,
       overall=c(left="Total"), 
       caption=caption)
```
